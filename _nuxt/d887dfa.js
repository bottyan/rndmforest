(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{251:function(e,t,n){var content=n(264);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(70).default)("643d0487",content,!0,{sourceMap:!1})},262:function(e,t,n){e.exports=function(){"use strict";function e(e){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var t in source)e[t]=source[t]}return e}function t(n,o){function r(t,r,c){if("undefined"!=typeof document){"number"==typeof(c=e({},o,c)).expires&&(c.expires=new Date(Date.now()+864e5*c.expires)),c.expires&&(c.expires=c.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var d="";for(var l in c)c[l]&&(d+="; "+l,!0!==c[l]&&(d+="="+c[l].split(";")[0]));return document.cookie=t+"="+n.write(r,t)+d}}function c(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],o={},i=0;i<t.length;i++){var r=t[i].split("="),c=r.slice(1).join("=");try{var d=decodeURIComponent(r[0]);if(o[d]=n.read(c,d),e===d)break}catch(e){}}return e?o[e]:o}}return Object.create({set:r,get:c,remove:function(t,n){r(t,"",e({},n,{expires:-1}))},withAttributes:function(n){return t(this.converter,e({},this.attributes,n))},withConverter:function(n){return t(e({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(o)},converter:{value:Object.freeze(n)}})}return t({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}()},263:function(e,t,n){"use strict";n(251)},264:function(e,t,n){var o=n(69)(!1);o.push([e.i,'.chat-block[data-v-8c5f3864]{min-height:100vh;position:relative}.chat-block .content .msg-line .msg-user[data-v-8c5f3864],.chat-block .content .msg-line .msg-user-resp[data-v-8c5f3864]{text-align:right}.input-holder[data-v-8c5f3864]{min-height:5rem;padding-bottom:2rem;position:-webkit-sticky;position:sticky;bottom:0}.input-holder .input-box[data-v-8c5f3864]{padding:1.5rem;border-radius:1rem;background:#fff;border:2px solid #000;box-shadow:1rem 1rem 4px 0 rgba(0,0,0,.72)}.input-holder .input-box input[data-v-8c5f3864]{width:calc(100% - 8px);border:solid #000;border-width:0 0 1px;font-size:1rem;margin-top:.6rem}.input-holder .input-box .choice-form .option-title[data-v-8c5f3864]{margin-bottom:0}.input-holder .input-box .choice-form .option[data-v-8c5f3864]{display:inline-block;margin-right:.8rem;margin-top:.8rem;border-radius:.5rem;overflow:hidden}.input-holder .input-box .choice-form .option .option-body[data-v-8c5f3864]{background:#add8e6;font-size:1rem;line-height:1em;padding:.8rem;cursor:pointer}.input-holder .input-box .choice-form .option[data-v-8c5f3864]:hover{box-shadow:.2rem .2rem 2px 0 rgba(0,0,0,.32)}.tiblock[data-v-8c5f3864]{align-items:center;display:flex;height:17px}.ticontainer .tidot[data-v-8c5f3864]{background-color:#90949c}.tidot[data-v-8c5f3864]{-webkit-animation:mercuryTypingAnimation-data-v-8c5f3864 1.5s ease-in-out infinite;border-radius:2px;display:inline-block;height:4px;margin-right:2px;width:4px}@-webkit-keyframes mercuryTypingAnimation-data-v-8c5f3864{0%{-webkit-transform:translateY(0)}28%{-webkit-transform:translateY(-5px)}44%{-webkit-transform:translateY(0)}}.tidot[data-v-8c5f3864]:first-child{-webkit-animation-delay:.2s}.tidot[data-v-8c5f3864]:nth-child(2){-webkit-animation-delay:.3s}.tidot[data-v-8c5f3864]:nth-child(3){-webkit-animation-delay:.4s}.messages[data-v-8c5f3864]{flex:1 1 auto;overflow:hidden;position:relative;width:100%}.messages .messages-content[data-v-8c5f3864]{position:relative;top:0;left:0;height:101%;width:100%}.messages .message[data-v-8c5f3864]{clear:both;float:left;padding:1rem;border-radius:10px 10px 10px 0;background:linear-gradient(120deg,rgba(0,160,176,.3),rgba(245,223,77,.3));font-size:1rem;line-height:1em;margin:8px 1.5rem 8px 0;position:relative}.messages .message .timestamp[data-v-8c5f3864]{position:absolute;bottom:-15px;font-size:9px;color:hsla(0,0%,100%,.3)}.messages .message[data-v-8c5f3864]:before{content:"";position:absolute;bottom:-6px;border-top:6px solid rgba(0,160,176,.3);left:0;border-right:7px solid transparent}.messages .message .avatar[data-v-8c5f3864]{position:absolute;z-index:1;bottom:-15px;left:-35px;border-radius:30px;width:30px;height:30px;overflow:hidden;margin:0;padding:0;border:2px solid hsla(0,0%,100%,.24)}.messages .message .avatar img[data-v-8c5f3864]{width:100%;height:auto}.messages .message.message-personal[data-v-8c5f3864]{float:right;color:#fff;text-align:right;background:linear-gradient(120deg,#248a52,#257287);border-radius:10px 10px 0 10px;margin-right:0;margin-left:1.5rem}.messages .message.message-personal[data-v-8c5f3864]:before{left:auto;right:0;border-right:none;border-left:5px solid transparent;border-top:4px solid #257287;bottom:-4px}.messages .message[data-v-8c5f3864]:last-child{margin-bottom:30px}.messages .message.new[data-v-8c5f3864]{transform:scale(0);transform-origin:0 0;-webkit-animation:bounce .5s linear both;animation:bounce .5s linear both}.input-anim[data-v-8c5f3864]{-webkit-animation:fadeIn-data-v-8c5f3864 1s;animation:fadeIn-data-v-8c5f3864 1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes fadeIn-data-v-8c5f3864{0%{opacity:0}to{visibility:visible;opacity:1}}@keyframes fadeIn-data-v-8c5f3864{0%{opacity:0}to{visibility:visible;opacity:1}}',""]),e.exports=o},295:function(e,t,n){"use strict";n.r(t);n(48),n(47),n(14),n(71),n(43),n(26),n(44),n(31),n(22),n(45),n(46),n(32);var o=n(262),r=n.n(o);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,r=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw r}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var l={layout:"dialogity",data:function(){return{connection:null,floatingMessage:null,uuid:null,cid:null,messages:[],messagesToShow:[],adding:!1}},mounted:function(){this.gsapInit(),console.log("Starting connection to WebSocket Server");var e=r.a.get("wtid");e&&""!==e||(e=this.dlgty_chb_guidGenerator(),r.a.set("wtid",e)),this.cid=e,this.uuid="d09fbd61d20c42de9023c7a8f2b0154e",this.initDialog()},beforeDestroy:function(){},methods:{initDialog:function(){var e=this.cid,t=this.uuid;this.connection=new WebSocket("wss://api2.dialogity.com/ws/chat");var n=this.connection,o=this;this.connection.onmessage=function(e){console.log("Message received:",e);var data=JSON.parse(e.data);"messages"===data.command?(console.log("Messages fetched:",data.messages),o.setMessages(data.messages)):"new_message"===data.command||"new_answer"===data.command?o.addMessage(data.message):"update_message"===data.command&&o.updateMessage(data.message)},this.connection.onopen=function(o){console.log(o),console.log("Successfully connected to the websocket server..."),n.send(JSON.stringify({command:"fetch_messages",uuid:t,cid:e,url:"chatbot"}))},this.connection.onclose=function(e){console.log("Socket is closed. Reconnect will be attempted in 1 ms.",e.reason),setTimeout((function(){console.log("TRY TO RECONNECT?")}),1)},this.constantCheck()},constantCheck:function(){var e=this;e.addMessageIfExists(),setTimeout((function(){return e.constantCheck()}),200)},reset:function(){this.messages=[],this.messagesToShow=[],this.floatingMessage=null,this.connection.close();var e=this.dlgty_chb_guidGenerator();r.a.set("wtid",e),this.cid=e},sendMsg:function(e){},clickOption:function(e,t){var n={command:"new_answer",message:{option:t},system_message:2,type:1,cid:this.cid,uuid:this.uuid,qid:e,lang:this.lang,url:"chatbot"};this.connection.send(JSON.stringify(n))},onEnter:function(e){var t=e.target.value;console.log("On Enter:",t),e.target.value="",this.connection.send(JSON.stringify({command:"new_message",message:t,type:1,cid:this.cid,uuid:this.uuid,lang:"ENG",is_html:0,url:"chatbot"}))},onEnterAnswer:function(e){var t={};t.value=e.target.value,console.log("On Enter:",t),e.target.value="";var n=parseInt(this.floatingMessage.id);this.connection.send(JSON.stringify({command:"new_answer",message:t,type:1,system_message:2,cid:this.cid,uuid:this.uuid,qid:n,lang:"ENG",is_html:0,url:"chatbot"}))},setMessages:function(e){console.log("MESSAGES"),this.messages=e,this.messagesToShow=this.messages.map((function(e){return e})),this.getFloatingMessage(),this.scrollToTheEnd()},addMessage:function(e){this.messages.push(e),this.getFloatingMessage(),this.scrollToTheEnd()},addMessageIfExists:function(){if(!this.adding&&this.messages.length>this.messagesToShow.length){this.adding=!0;var e=this.messages[this.messagesToShow.length],t=10;e.body_str&&(t=40*e.body_str.length,console.log("Wait for: ",t));var n=this;setTimeout((function(){n.adding=!1,n.messagesToShow.push(e),n.scrollToTheEnd()}),t)}},updateMessage:function(e){if(this.messages){for(var i=0;i<this.messages.length;i++)e.id===this.messages[i].id&&(this.messages[i].body=e.body,this.messages[i].system_message=e.system_message,this.messages[i].floating=e.floating);this.scrollToTheEnd()}else console.log("WARN: updateMessage failed because messages is empty")},getFloatingMessage:function(){this.floatingMessage=null;var e,t=c(this.messages);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.floating&&(this.floatingMessage=n)}}catch(e){t.e(e)}finally{t.f()}},getSelectedMessage:function(e,t){var n,o="",r=c(e);try{for(r.s();!(n=r.n()).done;){var option=n.value;option.id==t&&(o=option.text)}}catch(e){r.e(e)}finally{r.f()}return console.log("OPTION SELECTED:",o),o},dlgty_chb_guidGenerator:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},scrollToTheEnd:function(){var e=this;this.$nextTick((function(){e.$refs.containerToScroll;var t=e.$refs.containerContent.clientHeight,n=e.$refs.inputHolder.getBoundingClientRect().top,o=e.convertRemToPixels(6);if(console.log("SCROLL",t,n),t+o>n){var r=Math.max(0,t+o-n);console.log("scroll to:",r),window.scrollTo(0,r)}}))},convertRemToPixels:function(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)},gsapInit:function(){}}},m=(n(263),n(30)),component=Object(m.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"containerToScroll",staticClass:"chat-block max-width headspace"},[n("div",{ref:"containerContent",staticClass:"content messages",attrs:{id:"content"}},[n("div",{staticClass:"messages-content"},[e._l(e.messagesToShow,(function(t){return n("div",{key:t.id,staticClass:"msg-line"},[t.floating?e._e():n("div",[2==t.type&&t.body.option?n("div",{staticClass:"msg-user-resp message message-personal"},[e._v("\n              "+e._s(e.getSelectedMessage(t.body.options,t.body.option))+"\n            ")]):e._e(),e._v(" "),1==t.type&&0==t.system_message?n("div",{staticClass:"msg-user message message-personal"},[e._v("\n              "+e._s(t.body_str)+"\n            ")]):e._e(),e._v(" "),1==t.type&&2==t.system_message&&t.body.value?n("div",{staticClass:"msg-user message message-personal"},[e._v("\n              "+e._s(t.body.value)+"\n            ")]):e._e(),e._v(" "),0==t.type||2==t.type&&0==t.system_message?n("div",{staticClass:"msg-bot message"},[0==t.is_html?n("div",[e._v("\n                "+e._s(t.body)+"\n              ")]):e._e(),e._v(" "),1==t.is_html?n("div",[n("span",{domProps:{innerHTML:e._s(t.body)}})]):e._e()]):e._e()])])})),e._v(" "),e.adding?n("div",{staticClass:"msg-line"},[e._m(0)]):e._e()],2)])]),e._v(" "),n("div",{ref:"inputHolder",staticClass:"input-holder sticky",attrs:{id:"inputHolder"}},[n("div",{staticClass:"max-width"},[n("div",{staticClass:"input-box"},[e.messages.length==e.messagesToShow.length?n("div",{staticClass:"input-anim"},[e.floatingMessage?n("div",["form"==e.floatingMessage.body.type?n("div",{staticClass:"choice-form"},[n("div",{staticClass:"option-title"},[e._v(e._s(e.floatingMessage.body.text))]),e._v(" "),n("input",{attrs:{id:"freeTextInput",type:"text",autocomplete:"off"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnterAnswer.apply(null,arguments)}}})]):e._e(),e._v(" "),"choice"==e.floatingMessage.body.type?n("div",{staticClass:"choice-form"},[n("div",{staticClass:"option-title"},[e._v("Select an option 👇")]),e._v(" "),e._l(e.floatingMessage.body.options,(function(option){return n("div",{key:option.id,staticClass:"option"},[n("div",{staticClass:"option-body",on:{click:function(t){return e.clickOption(e.floatingMessage.id,option.id)}}},[e._v(e._s(option.text))])])}))],2):e._e()]):e._e(),e._v(" "),!e.floatingMessage||"choice"!==e.floatingMessage.body.type&&"form"!==e.floatingMessage.body.type?n("div",[n("input",{attrs:{id:"freeTextInput",type:"text",autocomplete:"off"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter.apply(null,arguments)}}})]):e._e()]):e._e()])])]),e._v(" "),n("div",{staticClass:"footer"})])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"msg-bot message"},[n("div",{staticClass:"ticontainer"},[n("div",{staticClass:"tiblock"},[n("div",{staticClass:"tidot"}),e._v(" "),n("div",{staticClass:"tidot"}),e._v(" "),n("div",{staticClass:"tidot"})])])])}],!1,null,"8c5f3864",null);t.default=component.exports}}]);