<template>
  <div class="container" id="scrollDist">
    <div class="bg"></div>
    <div id="trigger"></div>
    <div class="section section1">
      <div class="content-parent">
        <div class="header max-width">
          <div class="above-title"></div>
          <div class="title font-XXL">
            <h1>
              <div>FRIENDLY LIVE CHAT
              </div>
            </h1>
            
          </div>
          <div class="below-title font-XL">
            <h2>with handy features</h2>
          </div>
        </div>
      </div>
      <div class="bottom">
        <div class="bottom-container max-width">
          <div class="flex-space"></div>
          <div id="hide" class="next font-hand-L">
            see features üï∂Ô∏èüëá
          </div>
        </div>
      </div>
    </div>


    <div class="section section4">
      <div class="anim-holder">
        <div class="anim-frame"> 
          <div class="demo_holder max2-width">
            <div class="frame_title">
              <div class="text-inner">Answer quickly and easily</div>
            </div>

            <div class="multi-frame">

              <div class="demo_frame frame1 maxh2-width">
                <div class="image_holder">
                  <div class="text-holder">
                    <div class="dt1 text-center text-def font-hand-M">
                      <div class="text-inner">Select logo and color üé®</div>
                    </div>
                    <div class="dt2 text-center text-def font-hand-M">
                      <div class="text-inner">Write welcome message.</div>
                    </div>
                    <!--div class="custom3 text-center text-def font-hand-M">
                      <div class="text-inner">Edit the sites code or use a tag manager.</div>
                    </div-->
                  </div>
                  <img class="imgc1" src="~/assets/images/demo_live_chat/12 on site with welcome message - s.webp"/>
                  <img class="imgc2 imgb" src="~/assets/images/demo_live_chat/13 on site empty box - s.webp"/>
                  <img class="imgc3 imgb" src="~/assets/images/demo_live_chat/14 hi notification s.webp"/>
                  <img class="imgc4 imgb" src="~/assets/images/demo_live_chat/14 answer received s.webp"/>

                  <!--img class="imgc5 imgb" src="~/assets/images/demo_live_chat/09 welcome popup.webp"/>
                  <img class="imgc6" src="~/assets/images/demo_live_chat/14 hi notification c.webp"/>
                  <!img class="imgb6 imgb" src="~/assets/images/demo_live_chat/04.webp"/-->

                </div>
              </div>
              <div class="demo_frame frame2 maxh2-width">
                <div class="image_holder">
                  <div class="text-holder">
                    <div class="dat1 text-center text-def font-hand-M">
                      <div class="text-inner">ü¶∏‚Äç‚ôÄÔ∏è Agent is ready to answer questsion.</div>
                    </div>
                    <div class="dat2 text-center text-def font-hand-M">
                      <div class="text-inner">And she can do it immediately in the dynamic notification email.</div>
                    </div>
                    <!--div class="custom3 text-center text-def font-hand-M">
                      <div class="text-inner">Edit the sites code or use a tag manager.</div>
                    </div-->
                  </div>
                  <img class="imgca1" src="~/assets/images/demo_live_chat/17 email noti s.webp"/>
                  <img class="imgca2 imgb" src="~/assets/images/demo_live_chat/18 answer from email sent s.webp"/>
                  
                  
                  <!--img class="imgb6 imgb" src="~/assets/images/demo_live_chat/04.webp"/-->

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


    <div class="section section2">
      <div class="anim-holder">
        <div class="anim-frame">
          <div class="demo_holder max2-width">
            <div class="frame_title">
              <div class="text-inner">Easy installation</div>
            </div>
            <div class="demo_frame">
              <div class="image_holder">
                <div class="text-holder">
                  <div class="install1 text-center text-def font-hand-M">
                    <div class="text-inner">Just a few click to install üëÜ</div>
                  </div>
                  <div class="install2 text-center text-def font-hand-M">
                    <div class="text-inner">üèóÔ∏è Add this tiny code to your site.</div>
                  </div>
                  <div class="install3 text-center text-def font-hand-M">
                    <div class="text-inner">Edit the sites code or use a tag manager.</div>
                  </div>
                </div>
                <img class="img1" src="~/assets/images/demo_live_chat/s1 01 main screen.webp"/>
                <img class="img2 imgb" src="~/assets/images/demo_live_chat/s1 01 main screen b.webp"/>
                <img class="img3 imgb" src="~/assets/images/demo_live_chat/02 install.webp"/>
                <img class="img4 imgb" src="~/assets/images/demo_live_chat/02 install b.webp"/>

                <img class="img5 imgb" src="~/assets/images/demo_live_chat/03.webp"/>
                <img class="img6 imgb" src="~/assets/images/demo_live_chat/04.webp"/>
                <img class="img7 imgb" src="~/assets/images/demo_live_chat/12 on site with welcome message.webp"/>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="section section3">
      <div class="anim-holder">
        <div class="anim-frame">
          <div class="demo_holder max2-width">
            <div class="frame_title">
              <div class="text-inner">Customization</div>
            </div>
            <div class="demo_frame">
              <div class="image_holder">
                <div class="text-holder">
                  <div class="custom1 text-center text-def font-hand-M">
                    <div class="text-inner">Select logo and color üé®</div>
                  </div>
                  <div class="custom2 text-center text-def font-hand-M">
                    <div class="text-inner">Write welcome message.</div>
                  </div>
                  <!--div class="custom3 text-center text-def font-hand-M">
                    <div class="text-inner">Edit the sites code or use a tag manager.</div>
                  </div-->
                </div>
                <img class="imgb1" src="~/assets/images/demo_live_chat/07 settings messages.webp"/>
                <img class="imgb2 imgb" src="~/assets/images/demo_live_chat/06 customization avatar.webp"/>
                <img class="imgb3 imgb" src="~/assets/images/demo_live_chat/05 customization color.webp"/>
                <img class="imgb4 imgb" src="~/assets/images/demo_live_chat/08 welcome popup enable.webp"/>
                <img class="imgb5 imgb" src="~/assets/images/demo_live_chat/09 welcome popup.webp"/>

                <!--img class="imgb6 imgb" src="~/assets/images/demo_live_chat/04.webp"/-->

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="subscribe-holder">
        <div class="subscribe">
          <div class="subscribe-body">
            <a href="https://app.dialogity.com/registration">Start free trial</a>
          </div>
        </div>
      </div>
    </div>

  </div>
</template>

<script>
// TODO: mobile menu

export default {
  layout: 'dialogity',

  mounted() {
    this.animateOnScroll();
  },

  beforeDestroy() {
    this.$gsap.killTweensOf(".container");
    this.$gsap.killTweensOf(".section");
  },

  methods: {
    animateOnScroll() {
      const container = document.querySelector('.container');
      const header = document.querySelector('#menu-main');
      const footer = document.querySelector('.footer');
      const bg = document.querySelector('.bg');
      const tohide = document.querySelector('#hide');
      const animHolder = document.querySelector('.anim-holder');

      const _gsap = this.$gsap;
      const colorize = function(element) {
        //apply the colors to the element
        //console.log("element:", this);
        if (typeof this.ratio !== "undefined" && this.ratio !== 1) {
          const r = 0.3 * (1-this.ratio);
          //console.log("linear-gradient(141deg, " + "rgba(0,160,176," + r + ")" + " 0%, " + "rgba(207,92,120," + r + ")" + " 100%)");
          _gsap.set(bg, 
            { 
              //backgroundImage:"-webkit-linear-gradient(top," + this.vars.colorProps.top + ", " + this.vars.colorProps.bottom + ")",
              background: "linear-gradient(141deg, " + "rgba(245,223,77," + r + ")" + " 0%, " + "rgba(207,92,120," + r + ")" + " 100%)"
            });
        }
      }
      
      const tl = this.$gsap.timeline({defaults:{ease:'none'}, scrollTrigger:{trigger:'.section1', start:'top top', end:'bottom top', scrub: true}});
      tl.fromTo(bg, {}, {duration: 1, ease: "none", onUpdate:colorize})
        ;

      // =====================================================
      // == ANIM 1
      // =====================================================
      const img1 = document.querySelector('.img1');
      const t1 = document.querySelector('.install1');
      const img2 = document.querySelector('.img2');
      const img3 = document.querySelector('.img3');
      const t2 = document.querySelector('.install2');
      const t3 = document.querySelector('.install3');
      const img4 = document.querySelector('.img4');
      const img5 = document.querySelector('.img5');
      const img6 = document.querySelector('.img6');
      const img7 = document.querySelector('.img7');
      //const t4 = document.querySelector('.install4');
      const tl_anim = this.$gsap.timeline({defaults:{ease:'none'}, scrollTrigger:{trigger:'.section2', start:'top top', end:'bottom bottom', scrub: true}});
      tl_anim
        //.fromTo(animHolder, { opacity: 0 }, { duration: 0.5, opacity: 1, ease: "none" })
        .to(t1, {opacity: 1, duration: 1, ease: "none"},)
        .to(img1, {opacity: 0, duration: 1, ease: "none"},"<")
        
        .to(img1, {opacity: 1, duration: 1, ease: "none"},)
        .to(t1, {opacity: 0, duration: 1, ease: "none"},"<")
        
        .to(img1, {opacity: 0, duration: 1, ease: "none"},)
        .to(img2, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(t2, {opacity: 1, duration: 1, ease: "none"},"+=0.5")
        .to(img2, {opacity: 0, duration: 1, ease: "none"},"<")

        .to(img2, {opacity: 0, duration: 1, ease: "none"},"+1")
        .to(t2, {opacity: 0, duration: 1, ease: "none"},"<")

        .to(img3, {opacity: 1, duration: 1, ease: "none"},"+=1")
        .to(t2, {opacity: 0, duration: 1, ease: "none"},"<")

        .to(img3, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(img4, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(img4, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(img4, {x: "+100%", duration: 1, ease: "none"},"<")
        .to(t3, {opacity: 1, duration: 1, ease: "none"},"<")
        .from(t3, {x: "-100%", duration: 1, ease: "none"},"<")

        .to(t3, {opacity: 0, duration: 1, ease: "none"},"+=2")
        .to(img5, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(img5, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(img6, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(img6, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(img7, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(img7, {opacity: 0.99, duration: 1, ease: "none"},"+=2")
        ;

      // =====================================================
      // == ANIM 2
      // =====================================================
      const tc1 = document.querySelector('.custom1');
      const tc2 = document.querySelector('.custom2');
      const imgb1 = document.querySelector('.imgb1');
      const imgb2 = document.querySelector('.imgb2');
      const imgb3 = document.querySelector('.imgb3');
      const imgb4 = document.querySelector('.imgb4');
      const imgb5 = document.querySelector('.imgb5');
      
      const tl_anim2 = this.$gsap.timeline({defaults:{ease:'none'}, scrollTrigger:{trigger:'.section3', start:'top top', end:'bottom bottom', scrub: true}});
      tl_anim2
        .to(tc1, {opacity: 1, duration: 0.1, ease: "none"},)
        .to(imgb1, {opacity: 0, duration: 0.1, ease: "none"},"<")
        
        .to(tc1, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(imgb2, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(imgb3, {opacity: 1, duration: 1, ease: "none"},"+=1")
        .to(imgb2, {opacity: 0, duration: 1, ease: "none"},"<")

        .to(imgb3, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(tc2, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(tc2, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(imgb4, {opacity: 1, duration: 1, ease: "none"},"<")        

        .to(imgb5, {opacity: 1, duration: 1, ease: "none"},"+=1")
        .to(imgb4, {opacity: 0, duration: 1, ease: "none"},"<")
        ;
        
      // =====================================================
      // == ANIM 3
      // =====================================================
      const dt1 = document.querySelector('.dt1');
      const dt2 = document.querySelector('.dt2');
      const imgc1 = document.querySelector('.imgc1');
      const imgc2 = document.querySelector('.imgc2');
      const imgc3 = document.querySelector('.imgc3');
      const imgc4 = document.querySelector('.imgc4');
      const imgc5 = document.querySelector('.imgc5');
      const imgc6 = document.querySelector('.imgc6');

      const dat1 = document.querySelector('.dat1');
      const dat2 = document.querySelector('.dat2');
      const fr1 = document.querySelector('.frame1');
      const fr2 = document.querySelector('.frame2');
      const imgca1 = document.querySelector('.imgca1');
      const imgca2 = document.querySelector('.imgca2');
      
      const tl_anim3 = this.$gsap.timeline({defaults:{ease:'none'}, scrollTrigger:{trigger:'.section4', start:'top top', end:'bottom bottom', scrub: true}});
      tl_anim3

        .to(imgc1, {opacity: 1, duration: 1, ease: "none"},)
        .to(dat1, {opacity: 1, duration: 1, ease: "none"},"<")
        .to(imgca1, {opacity: 0, duration: 1, ease: "none"},"<")
        
        .to(imgc1, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(imgc2, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(imgc2, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(imgc3, {opacity: 1, duration: 1, ease: "none"},"<")
        
        .to(imgca1, {opacity: 1, duration: 1, ease: "none"},"+=0.1")
        .to(dat1, {opacity: 0, duration: 1, ease: "none"},"<")

        .to(imgca1, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(dat2, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(dat2, {opacity: 0, duration: 1, ease: "none"},"+=1")
        .to(imgca2, {opacity: 1, duration: 1, ease: "none"},"<")

        .to(imgc3, {opacity: 0, duration: 1, ease: "none"},"+=0.1")
        .to(imgc4, {opacity: 1, duration: 1, ease: "none"},"<")

        // .to(imgc1, {display: "none", duration: 0, ease: "none"},"+=1")
        // .to(imgc6, {display: "block", opacity: 1, duration: 0, ease: "none"},"<")
        // .to(fr2, {className: "demo_frame", duration: 0, ease: "none"},"<")
        //.to(fr2, {width: "100%", duration: 1, ease: "none"},"<")

        // .to(tc2, {opacity: 1, duration: 1, ease: "none"},"<")

        // .to(tc2, {opacity: 0, duration: 1, ease: "none"},"+=1")
        // .to(imgb4, {opacity: 1, duration: 1, ease: "none"},"<")        

        // .to(imgb5, {opacity: 1, duration: 1, ease: "none"},"+=1")
        // .to(imgb4, {opacity: 0, duration: 1, ease: "none"},"<")
        ;


      // tl.fromTo(container, 
      //       { background: 'linear-gradient(141deg, rgba(0,160,176,0.299918014012026) 0%, rgba(207,92,120,0.3027270027760709) 100%)' },
      //       { duration: 1, background: 'rgba(255, 255, 255, 0.0)', ease: "none" });

      // const tlh = this.$gsap.timeline({defaults:{ease:'none'}, scrollTrigger:{trigger:'.section1', start:'top top', end:'bottom top', scrub: true}});
      // tlh.fromTo(header, { background: 'rgba(255, 255, 255, 0.0)' }, { duration: 1, background: 'rgba(255, 255, 255, 1)', ease: "none" })
      //   .to(tohide, { duration: 1, opacity: 0, ease: "none" }, "<") ;

      
      // const mid = this.$gsap.timeline({defaults:{ease:'none'}, scrollTrigger:{trigger:'.section3', start:'top bottom', end:'bottom top', scrub: true}});
      // mid
      //   .to(bg, { duration: 1, background: 'rgba(0,88,155,0.2)', ease: "none" })
      //   .to(bg, { duration: 1, background: 'rgba(255,255,255,0)', ease: "none" });


      const tlf = this.$gsap.timeline({defaults:{ease:'none'}, scrollTrigger:{trigger:'.footer', start:'top bottom', end:'bottom bottom', scrub: true}});
      tlf
        .to(bg, { duration: 1, background: 'rgba(245,223,77,0.549918014012026)', ease: "none" })
        .to(animHolder, { duration: 1, opacity: 0, ease: "none" })
        // .fromTo(container, {background: 'rgba(255,255,255,0)'}, { duration: 1, background: 'rgba(245,223,77,0.549918014012026)', ease: "none" })
        // .to(footer, { duration: 1, background: 'rgba(245,223,77,0.549918014012026)', ease: "none" }, "<");

      

    },
  },
}
</script>

<style scoped lang="scss">
  .container {
    width: 100%;
    // background: linear-gradient(141deg, rgba(0,160,176,0.299918014012026) 0%, rgba(207,92,120,0.3027270027760709) 100%);
    background-attachment: fixed;

  }
  .bg {
    z-index: 1;
    height: 115vh;
    width: 100%;
    background: linear-gradient(141deg, rgba(245,223,77,0.3) 0%, rgba(207,92,120,0.3) 100%);
    position: fixed;
    top: 0px;
    left: 0px;
  }
  .anim-holder {
    position: sticky;
    width: 100%;
    height: 100vh;
    top: 0;
    left: 0;
    z-index: 20;
    //opacity: 0;
    .anim-frame {
      position: relative;
      width: 100%;
      height: 100%;
      //background-color: rgba(245,223,77,0.1);
    }
    .multi-frame {
      display: flex;
      flex-direction: row;
    }
  }
  .demo_holder {
    height: 100%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    .frame_title {
      font-family: 'Gotham-Black', 'Roboto', sans-serif;
      font-size: calc(min(3rem,min(100vh/25,100vw/28)));
      margin-bottom: 2rem;
    }
    .demo_frame {
      background: white;
      position: relative;
      border: 2px solid black;
      border-radius: 0.5rem;
      padding-top: 2rem;
      //overflow: hidden;
      //padding: 2rem 0.5rem 0.5rem 0.5rem;
      //background-color: #666;
      .image_holder {
        position: relative;
        overflow: hidden;
        background: white;
        border-bottom-left-radius: 0.5rem;
        border-bottom-right-radius: 0.5rem;
        border-top: 2px solid black;
        // border-left: 0.1rem solid rgb(128, 107, 81);
        //border-top: 0.1rem solid rgb(128, 107, 81);
        //border: 1px solid black;
        img {
          position: relative;
          width: 100%;
          max-height: 100%;
          display: block;
        }
        .imgb {
          position: absolute;
          top: 0;
          left: 0;
          opacity: 0;
        }
        .img1 { z-index: 10; opacity: 0; }
        .img2 { z-index: 9; }
        .img3 { z-index: 8; }
        .img4 { z-index: 7; }
        .imgb1 { opacity: 0; }
        .imgc6 { opacity: 0; display: none; }
        .imgca1 { opacity: 0; }
        .text-holder {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 100;
          .text-def {
            position: absolute;
            opacity: 0;
          }
          .text-center {
            width: 100%;
            height: 100%;
            top: 0%;
            left: 0%; 
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            .text-inner {
              padding: 1.5rem;
            }
          }  
          .install1 {
            opacity: 1;
          }
          .custom1 {
            opacity: 1;
          }
        }
        .dat1 {
          opacity: 1;
        }
      }
    }
    .frame2 {

    }
    .frame2-visible {

    }
    .demo_frame:after {
      content: "";
      width: 100%;
      height: 100%;
      background-color: #606060;
      filter: blur(1px);
      position: absolute;
      top: 1rem;
      left: 1rem;
      z-index: -1;
      border-radius: 0.5rem;
    }
  }

  .section {
    position: relative;
    width: 100%;
    height: 100vh;
    z-index: 10;
  }
  .section2 {
    height: 600vh;
  }
  .section3 {
    height: 350vh;
  }
  .section4 {
    height: 350vh;
  }
  .bottom {
    position: absolute;
    width: 100%;
    padding: 1rem 0 1rem 0;
    left: 0;
    bottom: 0;
    .bottom-container {
      display: flex;
      align-items: center;
      justify-content: center;
      .next {
        flex: 1 1 auto;
        //margin-bottom: 1rem;
        margin-bottom: 5rem;
      }
      @media only screen and (max-width: 768px) {
        .next {
          margin-bottom: 5rem;
        }
      }
    }
  }
  .content-parent {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    

    .header {

      .above-title {

      }
      .title {
        h1 {
          margin-block-start: 0.3em;
          margin-block-end: 0.3em;
        }
      }
      .below-title {
        h2 {
          margin-block-start: 0.3em;
          margin-block-end: 0.3em;
          font-size: 1em;
        }
      }
    }
  }

  .row {
    position: relative;
    width: 100%;
    z-index: 10;
  }
  .subscribe-holder {
    display: flex;
    justify-content: center;
    margin-top: 6rem;

    .subscribe {
      display: inline-block;
      margin-right: 0.8rem;
      margin-top: 0.8rem;
      border-radius: 1rem;
      overflow: hidden;
      border: 2px solid black;
      box-shadow: .5rem .5rem 2px 0px rgba(0,0,0,0.62);
      background: black;

      .subscribe-body {
        background: black;
        a {
          font-size: 2rem;
          line-height: 2em;
          padding: 1.5rem;
          cursor: pointer;
          background: black;
          color: white;
          text-decoration: none;
        }
      }
    }
    .subscribe:hover {
      box-shadow: 1rem 1rem 2px 0px rgba(0,0,0,0.62);
      background: lightblue;
      .subscribe-body {
        background: lightblue;
        a {
          background: lightblue;
          color: black;
        }
      }
    }
  }
</style>